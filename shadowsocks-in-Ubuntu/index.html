<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="墨润生烟雨，剑舞破山河"><title>Ubuntu下配置Shadowsocks實戰攻略 | 九燈</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-113302990-1','auto');ga('send','pageview');
</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Ubuntu下配置Shadowsocks實戰攻略</h1><a id="logo" href="/.">九燈</a><p class="description">朝蒸藜藿暮烹葵</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Ubuntu下配置Shadowsocks實戰攻略</h1><div class="post-meta">Jun 23, 2015<span> | </span><span class="category"><a href="/categories/瞎搞/">瞎搞</a></span></div><div class="post-content"><h3 id="我來還文章了，這是第一篇"><a href="#我來還文章了，這是第一篇" class="headerlink" title="我來還文章了，這是第一篇"></a>我來還文章了，這是第一篇</h3><p>這麼久終於要迎來第一篇真正意義上的技術貼了。內牛滿面啊TAT</p>
<p>前段時間拿到了一個ss帳號，在win下配置成功，沒有在UBUNTU下嘗試</p>
<p>畢竟我原本有hosts保底，對這個需求不是那麼強烈</p>
<p>事實上，如果對fq只有谷歌搜索的需求，hosts已經夠了</p>
<p>前幾天心血來潮，想着在UBUNTU也設置一個</p>
<p>遇到一些問題，不過最後弄好了，拿出來分享一下</p>
<a id="more"></a>

<p>&nbsp;</p>
<p>好了下面開始正題，先把流程說一遍</p>
<p>1.</p>
<p>執行命令,安裝ss環境</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get <span class="keyword">install</span> python-pip</span><br><span class="line">pip <span class="keyword">install</span> shadowsocks</span><br></pre></td></tr></table></figure>

<p>2.</p>
<p>連接的方法， 有兩種</p>
<p>一，直接在终端用命令：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sslocal -s 服務器地址 -p 服務器端口  -k 密碼 -t <span class="number">600</span> -m aes<span class="number">-256</span>-cfb</span><br></pre></td></tr></table></figure>

<p>也可以把ss启动命令写成shell脚本</p>
<p>二，用配置文件启动：<br>在/etc新建一個文件，文件名隨意，後綴.json，比如我的是ss.json</p>
<p>添加以下內容</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"server"</span> : <span class="string">"服務器地址"</span>,</span><br><span class="line"><span class="attr">"server_port"</span> : 服務器端口,</span><br><span class="line"><span class="attr">"local_port"</span> : 本地端口,</span><br><span class="line"><span class="attr">"password"</span> : <span class="string">"密碼"</span>,</span><br><span class="line"><span class="attr">"timeout"</span> : <span class="number">600</span>,</span><br><span class="line"><span class="attr">"method"</span> : <span class="string">"加密方式"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动时使用命令：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sslocal -c <span class="regexp">/etc/</span>ss.json</span><br></pre></td></tr></table></figure>

<p>以上是前臺運行</p>
<p>後臺運行：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sslocal -s servername -p <span class="number">443</span> -k password -t <span class="number">600</span> -m rc4-md5 --<span class="keyword">user</span> <span class="title">你的用戶名 -d</span> <span class="literal">start</span></span><br></pre></td></tr></table></figure>

<p>使用設定檔的話就是</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sslocal -c /etc/ss.json --<span class="keyword">user</span> <span class="title">Fooooo</span> -d <span class="literal">start</span></span><br></pre></td></tr></table></figure>

<p>然後關閉的時候把start改成stop就可以了</p>
<p>也可以不用關閉，你不用的話十分鐘自動給你退出</p>
<p>检查日志：</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo less /<span class="built_in">var</span>/<span class="keyword">log</span>/shadowsocks.<span class="keyword">log</span></span><br></pre></td></tr></table></figure>

<p>到這裏ss就設置好了，接下來只要設置一下瀏覽器代理就好，這裏先賣一下關子</p>
<p>&nbsp;</p>
<p>輸入sslocal,可以看到以下參數<br><code>Proxy options:</code><br><code>-c CONFIG path to config file  //調用配置文件</code><br><code>-s SERVER_ADDR server address  //服務器地址</code><br><code>-p SERVER_PORT server port, default: 8388  //服務器端口</code><br><code>-b LOCAL_ADDR local binding address, default: 127.0.0.1  //本機，一般不需要設置</code><br><code>-l LOCAL_PORT local port, default: 1080  //本地端口，一般不需設置</code><br><code>-k PASSWORD password  //你的密碼</code><br><code>-m METHOD encryption method, default: aes-256-cfb  //加密方式</code><br><code>-t TIMEOUT timeout in seconds, default: 300  //斷開超時，即300s後自動離線，一般用600s</code><br><code>--fast-open use TCP_FASTOPEN, requires Linux 3.7+  //這個是有侷限的，一般也用不到</code><br><code></code><br><code>General options:</code><br><code>-h, --help show this help message and exit  //幫助</code><br><code>-d start/stop/restart daemon mode  //相當於上線，離線，重鏈接</code><br><code>--pid-file PID_FILE pid file for daemon mode  //</code><br><code>--log-file LOG_FILE log file for daemon mode  //這兩個都不懂</code><br><code>--user USER username to run as  //後臺運行的時候用的，後面講</code><br><code>-v, -vv verbose mode</code><br><code>-q, -qq quiet mode, only show warnings/errors</code><br><code>--version show version information</code><br><code></code><br>` &nbsp;<br>要說的是，ss有兩個命令，一個是ssserver,另一個是sslocal</p>
<p>網上教程兩個都有，兩個的參數是一樣的，但是並不是兩個都能用</p>
<p>我一開始也在這裏栽了，查了好久才發現兩者使用情況不同</p>
<p>前者是服務器用的，後面的纔是我們個人電腦用的</p>
<p>也就是說，sslocal 是開啓本地ss接口</p>
<p>然後在瀏覽器設置把特定流量轉到這個本地端口，就可以科學上網了</p>
<p>如果你用的是ssserver,會出來錯誤信息,說連不上服務器<br><code>[Errno 99] Cannot assign requested address</code><br>網上說把服務器改成0.0.0.0就可以了</p>
<p>那就是本機了好嗎你的不是服務器啊親~</p>
<p>所以乖乖用sslocal吧</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>關於前臺式的啓動，你的命令沒有關閉，會一直顯示鏈接信息，像你用ping一樣<br><code>2015-06-23 20:08:37 INFO connecting www.google.com:443 from 127.0.0.1:37394</code><br><code>2015-06-23 20:08:37 INFO connecting www.google.com:443 from 127.0.0.1:37396</code><br><code>2015-06-23 20:08:37 INFO connecting www.google.com:443 from 127.0.0.1:37398</code><br><code>2015-06-23 20:08:37 INFO connecting www.youtube.com:443 from 127.0.0.1:37404</code><br><code>2015-06-23 20:08:39 INFO connecting i.ytimg.com:443 from 127.0.0.1:37406</code><br><code>2015-06-23 20:08:39 INFO connecting i.ytimg.com:443 from 127.0.0.1:37407</code><br><code>2015-06-23 20:08:39 INFO connecting i.ytimg.com:443 from 127.0.0.1:37412</code><br><code>2015-06-23 20:08:39 INFO connecting i.ytimg.com:443 from 127.0.0.1:37414</code><br><code>2015-06-23 20:08:39 INFO connecting i.ytimg.com:443 from 127.0.0.1:37416</code><br><code>2015-06-23 20:08:39 INFO connecting i.ytimg.com:443 from 127.0.0.1:37417</code><br><code>2015-06-23 20:08:39 INFO connecting yt3.ggpht.com:443 from 127.0.0.1:37420</code><br><code>2015-06-23 20:08:39 INFO connecting yt3.ggpht.com:443 from 127.0.0.1:37422</code><br><code>2015-06-23 20:08:41 INFO connecting gg.google.com:443 from 127.0.0.1:37424</code><br><code>2015-06-23 20:08:42 INFO connecting apis.google.com:443 from 127.0.0.1:37426</code><br><code>2015-06-23 20:08:42 INFO connecting oauth.googleusercontent.com:443 from 127.0.0.1:37427</code><br><code>2015-06-23 20:08:42 INFO connecting content.googleapis.com:443 from 127.0.0.1:37430</code><br>&nbsp;</p>
<p>最後是瀏覽器設置，Ubuntu並不能像Win那麼傻瓜化，我們還要進行瀏覽器的設置</p>
<p>據說可以通過系統代理，不過爲了更好的可定製性，還是瀏覽器插件好用</p>
<p>我用的是chrome，就基於chrome說下設置的方法，其他的也類似啦<br><code>首先安裝插件SwitchyOmega</code><br><code></code><br><code>裝好後設置代理模式</code><br><img src="/images/150623-ss-1.png" alt></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>要做的很簡單，代理選socks5.把本地代理填進去。就可以實現把特定流量轉到ss的本地端口，實現代理<br>然後設置自動切換<br>這樣可以把實現瀏覽牆外網站時自動使用代理，不至於把國內訪問速度拖慢，也不用麻煩地手動切換</p>
<p>&nbsp;</p>
<p><img src="/images/150623-ss-auto.png" alt></p>
<p>&nbsp;</p>
<p>應該挺好理解的，遇到規則內網站使用ss，否則直連</p>
<p>規則地址是<a href="http://autoproxy-gfwlist.googlecode.com/svn/trunk/gfwlist.txt" target="_blank" rel="noopener">http://autoproxy-gfwlist.googlecode.com/svn/trunk/gfwlist.txt</a></p>
<p>據說是一個閒的蛋疼的人維護的==</p>
<p>如果你想更方便，也可以開啓快速切換，想這樣，點一下或者按一下快捷鍵，開啓自動模式，再按一下，退出</p>
<p><img src="/images/150623-ss-c.png" alt></p>
<p>&nbsp;</p>
<p>其實一直掛着也沒什麼問題，如果你有特殊需要可以這樣設置，僅作一個功能介紹</p>
<h3 id="完結撒花"><a href="#完結撒花" class="headerlink" title="完結撒花"></a>完結撒花</h3><p>寫了好久終於完成，設置過程參考了兩個網頁並加上個人的實戰經驗，完結</p>
<p><a href="https://github.com/shadowsocks/shadowsocks/wiki/Shadowsocks-%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks/wiki/Shadowsocks-%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E</a></p>
<p><a href="http://www.zhihu.com/question/26418370" target="_blank" rel="noopener">http://www.zhihu.com/question/26418370</a></p>
<p>&nbsp;</p>
<p>如果需要開機啓動，知乎裏有一條命令，我沒試過，不包成功</p>
<p>在/etc/rc.local中添加启动命令。<br>例如:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/rc.<span class="keyword">local</span></span><br></pre></td></tr></table></figure>

<p>在exit 0前添加(这里假设你已经在第2步写好shell脚本，并命名为ss_start.sh)</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="keyword">sh</span> /path/<span class="keyword">to</span>/sslocal/ss_start.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure>

<p>如果路径和权限都没问题，在下次开机时就会启动ss了。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div><div class="tags"><a href="/tags/科学上网/">科学上网</a><a href="/tags/VPS/">VPS</a></div><div class="post-nav"><a class="pre" href="/the-future/">未來</a><a class="next" href="/233/">233</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: '01ed4a49fecbbf37b647',
  clientSecret: '48a91fee8ca434a06aa40e02f8fc1c8933163951',
  repo: 'ferristale.github.io',
  owner: 'ferristale',
  admin: ['ferristale'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://ferristale.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/分享/">分享</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂文/">杂文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/瞎搞/">瞎搞</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/VPS/" style="font-size: 15px;">VPS</a> <a href="/tags/杂记/" style="font-size: 15px;">杂记</a> <a href="/tags/杂谈/" style="font-size: 15px;">杂谈</a> <a href="/tags/网站相关/" style="font-size: 15px;">网站相关</a> <a href="/tags/折腾/" style="font-size: 15px;">折腾</a> <a href="/tags/WP/" style="font-size: 15px;">WP</a> <a href="/tags/杂念/" style="font-size: 15px;">杂念</a> <a href="/tags/音乐/" style="font-size: 15px;">音乐</a> <a href="/tags/摄影/" style="font-size: 15px;">摄影</a> <a href="/tags/荐文/" style="font-size: 15px;">荐文</a> <a href="/tags/扇貝/" style="font-size: 15px;">扇貝</a> <a href="/tags/科学上网/" style="font-size: 15px;">科学上网</a> <a href="/tags/读书/" style="font-size: 15px;">读书</a> <a href="/tags/电影/" style="font-size: 15px;">电影</a> <a href="/tags/美剧/" style="font-size: 15px;">美剧</a> <a href="/tags/无题/" style="font-size: 15px;">无题</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Lyric-Ghost/" style="font-size: 15px;">Lyric-Ghost</a> <a href="/tags/Wifi/" style="font-size: 15px;">Wifi</a> <a href="/tags/读研/" style="font-size: 15px;">读研</a> <a href="/tags/扇贝/" style="font-size: 15px;">扇贝</a> <a href="/tags/科普/" style="font-size: 15px;">科普</a> <a href="/tags/看剧/" style="font-size: 15px;">看剧</a> <a href="/tags/回忆录/" style="font-size: 15px;">回忆录</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://www.iplaysoft.com/" title="异次元软件：不错的软件分享站" target="_blank">异次元软件：不错的软件分享站</a><ul></ul><a href="https://tinypng.com/" title="TinyPng：高质量在线图片压缩" target="_blank">TinyPng：高质量在线图片压缩</a><ul></ul><a href="https://smallpdf.com" title="Smallpdf：优秀的PDF在线工具" target="_blank">Smallpdf：优秀的PDF在线工具</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">九燈.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" color="0,0,0" opacity="0.5" zindex="-2" count="30" src="//lib.baomitu.com/canvas-nest.js/2.0.4/canvas-nest.umd.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>